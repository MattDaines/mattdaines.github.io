<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Technology Notebook</title><link>https://notebook.mattdaines.me/</link><description>Recent content on Technology Notebook</description><generator>Hugo -- gohugo.io</generator><language>en-gb</language><lastBuildDate>Sat, 27 Jan 2024 00:00:00 +0000</lastBuildDate><atom:link href="https://notebook.mattdaines.me/index.xml" rel="self" type="application/rss+xml"/><item><title>Doing Things The Hard Way</title><link>https://notebook.mattdaines.me/p/doing-things-the-hard-way/</link><pubDate>Sat, 27 Jan 2024 00:00:00 +0000</pubDate><guid>https://notebook.mattdaines.me/p/doing-things-the-hard-way/</guid><description>&lt;img src="https://notebook.mattdaines.me/p/doing-things-the-hard-way/header-image.png" alt="Featured image of post Doing Things The Hard Way" />&lt;p>To be a well-rounded infrastructure engineer you need exposure and experience to various technologies. For example, networking, hardware, operating systems and applications. On the soft skills side, troubleshooting and problem solving.&lt;/p>
&lt;p>To be candid, I think a lot of what I&amp;rsquo;ve done recently professionally has been quite easy - this sounds like a brag, it’s not meant to be. It’s an acknowledgement of how the public cloud makes consuming cloud services very easy relative to on-premises data centres.&lt;/p>
&lt;p>As a passionate technologist (and an Azure cloud consultant professionally) I love the challenge of picking something I&amp;rsquo;ve not done before and trying to figure it out. That doesn&amp;rsquo;t happen often for me anymore. But I know that’s not the case for everyone. Why is that? What&amp;rsquo;s the difference between the start of my career and some of my colleagues?&lt;/p>
&lt;p>I put it down to a lack of focus and training on the fundamentals of computing. For context I&amp;rsquo;m not talking about different types of gates within a processor like you might find on computer science courses at university. I&amp;rsquo;m sure that&amp;rsquo;s very important for some professions but it’s not important for what I do professionally. I&amp;rsquo;m talking networking (OSI model, CIDR, subnets, routes, etc), Windows Server (Active Directory Domain Services, IIS, Hyper-V), and an understanding of public key infrastructure (PKI).&lt;/p>
&lt;p>I can&amp;rsquo;t, and don’t blame anybody for not knowing what I consider to be the fundamentals. On a day-to-day basis I don&amp;rsquo;t need to know all of this. In Azure, if I need to get my virtual machine to go via a firewall before it goes to the Internet then I just tell Azure’s software defined networking via a user defined route to go to the frontend IP of an Azure firewall. Concepts like the default gateway are abstracted away. A positive argument to this abstraction is that it’s making cloud engineers more productive and enables more people to get involved with Azure, and I’m sure other cloud providers. But when things go wrong, how do people troubleshoot?&lt;/p>
&lt;p>LLMs like ChatGPT, Bard, Llama are a fascinating technology! But I&amp;rsquo;m not sure that people are using them correctly when it comes to problem solving and troubleshooting. From what I&amp;rsquo;ve seen, whenever someone turns to an LLM to solve their problem, they just try to get an answer and not the understanding of why the solution works the way it does. They&amp;rsquo;re likely doomed to face the same challenge when they&amp;rsquo;re presented with the same problem but portrayed in a different way. If you&amp;rsquo;re using LLMs to help you solve problems, make sure that you ask the LLM to explain the solution to you in way that you can understand it!&lt;/p>
&lt;p>So, what am I doing about my lack of challenge? Well, I&amp;rsquo;m moving my blog from GitHub pages to a Kubernetes cluster hosted on Raspberry Pis. Why? There&amp;rsquo;s a lot of technology that I need to understand that I have either not worked with for a long time or not at all!
By doing this I&amp;rsquo;ll need to learn:&lt;/p>
&lt;ul>
&lt;li>Physical infrastructure&lt;/li>
&lt;li>Monitoring that infrastructure&lt;/li>
&lt;li>Alerting when something goes wrong&lt;/li>
&lt;li>Deploy and manage a self-hosted Kubernetes cluster&lt;/li>
&lt;li>Host applications and services on Kubernetes&lt;/li>
&lt;li>Monitor the applications (similar to infrastructure, I know)&lt;/li>
&lt;li>Dockerise my blog, in a highly available way&lt;/li>
&lt;li>Linux, a nemesis of mine&lt;/li>
&lt;/ul>
&lt;p>And I’m sure a lot more! I hope to blog about the challenges I face as I go through this process. See you on the other side! And I&amp;rsquo;d encourage you to think about where you can do things the hard way to become a more resilient person.&lt;/p></description></item><item><title>Authenticating as a Service Principal</title><link>https://notebook.mattdaines.me/p/authenticating-as-a-service-principal/</link><pubDate>Fri, 19 May 2023 00:00:00 +0000</pubDate><guid>https://notebook.mattdaines.me/p/authenticating-as-a-service-principal/</guid><description>&lt;img src="https://notebook.mattdaines.me/p/authenticating-as-a-service-principal/header-image.png" alt="Featured image of post Authenticating as a Service Principal" />&lt;p>On rare occasions, you may sometimes need to log in with an Azure service principal. Below is a code snippet that you can use to authenticate as a service principal. You will need to know the client ID and either know a client secret that has been generated or have access to a client certificate.&lt;/p>
&lt;p>Once signed in, you &lt;em>are&lt;/em> that service principal. So running commands like &lt;code>Get-AzSubscription&lt;/code> or &lt;code>Get-AzResourceGroup&lt;/code> may help with identifying role-based access control issues.&lt;/p>
&lt;h2 id="login-as-service-principal-with-secret">Login As Service Principal with Secret&lt;/h2>
&lt;h3 id="powershell">PowerShell&lt;/h3>
&lt;p>Reference: &lt;a class="link" href="https://learn.microsoft.com/en-us/powershell/module/az.accounts/connect-azaccount#example-3-connect-to-azure-using-a-service-principal-account" target="_blank" rel="noopener"
>MS Learn - Connect to Azure using a service principal account&lt;/a>&lt;/p>
&lt;p>This snippet is really here because I forget how to generate the &lt;code>$Credential&lt;/code> object everytime I need to do this!&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Stores what is effectively the username and password in two variables.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$ClientId&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mf">00000000&lt;/span>&lt;span class="p">-&lt;/span>&lt;span class="mf">0000&lt;/span>&lt;span class="p">-&lt;/span>&lt;span class="mf">0000&lt;/span>&lt;span class="p">-&lt;/span>&lt;span class="mf">0000&lt;/span>&lt;span class="p">-&lt;/span>&lt;span class="mf">000000000000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$ClientPassword&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">Generated&lt;/span> &lt;span class="n">Secret&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Creates a PSCredential object using the username and password&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$Credential&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">New-Object&lt;/span> &lt;span class="n">-TypeName&lt;/span> &lt;span class="n">System&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="py">Management&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="py">Automation&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="py">PSCredential&lt;/span> &lt;span class="p">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">-ArgumentList&lt;/span> &lt;span class="nv">$ClientId&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$ClientPassword&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">ConvertTo-SecureString&lt;/span> &lt;span class="n">-AsPlainText&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Uses the PSCredential object to authenticate with Azure to a particular Azure tenant&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Connect-AzAccount&lt;/span> &lt;span class="n">-ServicePrincipal&lt;/span> &lt;span class="p">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">-TenantId&lt;/span> &lt;span class="nv">$TenantId&lt;/span> &lt;span class="p">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">-Credential&lt;/span> &lt;span class="nv">$Credential&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Enabling/Disabling Network Level Authentication (NLA)</title><link>https://notebook.mattdaines.me/p/enabling/disabling-network-level-authentication-nla/</link><pubDate>Tue, 09 May 2023 00:00:00 +0000</pubDate><guid>https://notebook.mattdaines.me/p/enabling/disabling-network-level-authentication-nla/</guid><description>&lt;blockquote>
&lt;p>The remote computer that you are trying to connect to requires Network Level Authentication (NLA), but your Windows domain controller cannot be contacted to perform NLA. If you are an administrator on the remote computer, you can disable NLA by using the options on the Remote tab of the System Properties dialog box.&lt;/p>
&lt;/blockquote>
&lt;p>A frustrating error that you may occasionally bump into while configuring Windows server infrastructure. It&amp;rsquo;s likely that a networking issue is preventing the member server from contacting the domain controller. Even after the networking issue is resolved, a domain admin (or, another privileged admin) would need to re-establish the trust to the domain controller from the member server.&lt;/p>
&lt;p>My, admittedly somewhat limited knowledge of the issue of why this happens is when the domain member tries to reset it&amp;rsquo;s own password/credential and can&amp;rsquo;t due to a network issue (I&amp;rsquo;m sure there&amp;rsquo;s other reason, but that&amp;rsquo;s the most common from my personal experience). The machine password expires and then the member server cannot authenticate to the domain, which is part of the authentication process for domain accounts when NLA is enabled.&lt;/p>
&lt;p>This page will list a few PowerShell cmdlets that I run when I&amp;rsquo;m happy that the member server can be brought back. Just don&amp;rsquo;t forget to re-enable NLA once you&amp;rsquo;re the computer is trusted again.&lt;/p>
&lt;h2 id="disable-network-level-authentication-nla">Disable Network Level Authentication (NLA)&lt;/h2>
&lt;p>In Azure, you likely need to run this from the Run Command blade on the target virtual machine.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nb">Get-WmiObject&lt;/span> &lt;span class="n">-class&lt;/span> &lt;span class="n">Win32_TSGeneralSetting&lt;/span> &lt;span class="n">-Namespace&lt;/span> &lt;span class="n">root&lt;/span>&lt;span class="p">\&lt;/span>&lt;span class="n">cimv2&lt;/span>&lt;span class="p">\&lt;/span>&lt;span class="n">terminalservices&lt;/span> &lt;span class="n">-ComputerName&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">hostname&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">-Filter&lt;/span> &lt;span class="s2">&amp;#34;TerminalName=&amp;#39;RDP-tcp&amp;#39;&amp;#34;&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="py">SetUserAuthenticationRequired&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mf">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>You should now be able to remote on with the local administrator account. If you&amp;rsquo;re not sure what the local administrator account is, you can use the Reset Password blade in the Azure portal - this creates a new local admin account if it does not already exist or resets the password if it does.&lt;/p>
&lt;h2 id="domain-trust">Domain Trust&lt;/h2>
&lt;p>If you successfully remote onto the virtual machine with the local admin credential, you can now reset the computer password and re-establish the trust with the domain.&lt;/p>
&lt;p>For &lt;code>&amp;lt;Domain&amp;gt;\&amp;lt;User&amp;gt;&lt;/code> you&amp;rsquo;ll want to use the domain account, not the local account. You&amp;rsquo;ll be prompted for the password.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Reset-ComputerMachinePassword&lt;/span> &lt;span class="n">-Credential&lt;/span> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">Domain&lt;/span>&lt;span class="p">&amp;gt;\&amp;lt;&lt;/span>&lt;span class="n">User&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="enable-network-level-authentication-nla">Enable Network Level Authentication (NLA)&lt;/h2>
&lt;p>Assuming the &lt;code>Reset-ComputerMachinePassword&lt;/code> succeeded, you can now re-enable NLA and log back on with your domain account.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nb">Get-WmiObject&lt;/span> &lt;span class="n">-class&lt;/span> &lt;span class="n">Win32_TSGeneralSetting&lt;/span> &lt;span class="n">-Namespace&lt;/span> &lt;span class="n">root&lt;/span>&lt;span class="p">\&lt;/span>&lt;span class="n">cimv2&lt;/span>&lt;span class="p">\&lt;/span>&lt;span class="n">terminalservices&lt;/span> &lt;span class="n">-ComputerName&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">hostname&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">-Filter&lt;/span> &lt;span class="s2">&amp;#34;TerminalName=&amp;#39;RDP-tcp&amp;#39;&amp;#34;&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="py">SetUserAuthenticationRequired&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mf">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Archives</title><link>https://notebook.mattdaines.me/archives/</link><pubDate>Sun, 06 Mar 2022 00:00:00 +0000</pubDate><guid>https://notebook.mattdaines.me/archives/</guid><description/></item><item><title/><link>https://notebook.mattdaines.me/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://notebook.mattdaines.me/</guid><description/></item><item><title>Search</title><link>https://notebook.mattdaines.me/search/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://notebook.mattdaines.me/search/</guid><description/></item></channel></rss>